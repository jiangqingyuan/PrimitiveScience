# 软件部署

· 当我们有一些代码要发布时，我们将需要部署它。部署是确保软件安装在正确位置的过程，确保软件安全以防止任何黑客攻击，并确保授予软件权限以便其可以根据需要读写文件。
当代码被部署时，我们通常希望再次测试它，以确保一切仍然按预期的方式工作。
部署代码通常分几个步骤完成。开发人员通常会在开发过程中使用一个服务器。这就是所谓的开发服务器，在开发过程中，代码可以在这个服务器上执行和测试。通常会附带一个开发数据库，如果我们开发的应用程序使用数据库，那么这个数据库是用来模拟应用程序处理的真实数据的。尽管如此，它仍然可以按照开发人员想要的任何方式进行修改，因为它与用户看到和使用的真实数据是分离的。

· 在将代码移动到生产服务器（即应用程序用户将用于运行应用程序的服务器）之前，通常将代码移动到中间服务器（通常称为登台服务器）。
staging server。
此服务器的作用是尽可能地与生产服务器相似，以便可以与已经发布的代码一起测试新代码。这样做的目的是确保一切顺利运行，并且在新代码到达实时生产服务器时不会出现错误。
临时服务器也有一个数据库。此数据库中的数据通常是从生产数据库复制来的，以确保一切都是真实服务器的镜像。

最后，当团队确信一切工作正常时，将代码移动到生产服务器。除了移动代码之外，还可能需要进行其他调整，例如向生产数据库中添加新软件版本所需的内容，添加新代码所使用的其他应用程序和代码库，等等。

· 我们还必须有一个策略，如果需要的话，我们可以撤销这个部署。
无论我们的测试多么彻底，当代码进入生产环境并且用户开始使用它时，我们从未想象过的事情开始出现。用户可能会以不可预测的方式行事，并且生产环境与我们忽略的登台环境之间可能存在差异。
我们总是抱着最好的希望，但我们需要一个计划，如果事与愿违，我们将做些什么。我们想要的是一种方法来撤销所有的更改，并尽快恢复到部署之前的状态。这就是所谓的回滚策略。
我们可以通过几种方式来完成这样的回滚。其中之一是在部署之前备份生产数据库。通过这种方式，我们可以确保在新代码发布之前，对应用程序中的所有数据有一个快照。
实际代码通常在VCS的帮助下部署到服务器，因此将实际代码回滚到以前的版本相当简单。

将代码部署到生产环境中所涉及的步骤通常是自动化的，这意味着不同的工具和应用程序负责所有步骤。让我们来看看这个自动化是如何工作的。

· 
部署自动化
尽可能多地自动化部署步骤通常是个好主意。原因是，通常需要按正确的顺序执行许多步骤，这是一项非常适合自动化的工作。同时，它也是人类经常犯错误，忘记做某事或按错误顺序做某事的事情。
根据系统的复杂性，我们可以使用几个工具来帮助我们完成自动化部署。
自动化部署将确保我们有高质量的代码，因为自动化过程通常运行测试，并让代码通过测试的生产服务器。
它还将节省时间，因为部署工具执行部署步骤的速度要比人工执行时快得多。
当部署代码时，使用它的工作还没有结束。必须维护已部署的代码。

· 代码维护
典型的软件开发人员将花费更多的时间维护现有代码，而不是编写令人兴奋的新功能。
如果我们仔细想想，这并不奇怪。
首先，应用程序的生命周期通常比开发它所花费的时间长得多。这意味着有越来越多的软件正在运行和执行其任务。
使用的程序将始终需要维护，因为用户会发现我们必须修复的错误，随着用户需求的变化，新功能将被添加到应用程序中，并且必须更新和改进旧功能。
这意味着开发人员将大部分时间花在旧代码上，修复和更新它。这可以是几十年前由很久以前离开公司的人编写的代码，也可以是您在前一周编写的代码。
如果你提前想想你作为程序员的生活会是什么样子，你很可能会想象自己在编写新的、令人兴奋的软件，使用最新的工具和功能。尽管如此，事实是，你更有可能在很久以前编写的代码中四处闲逛，使用你在学前班时发布的语言版本。
有时，你将有机会编写全新的、很酷的、闪亮的软件，但请记住，如果你做得好，这些代码将继续存在，并且将来需要由其他人（或你自己）维护。
这就是软件开发人员的生活。这意味着我们需要确保我们编写的代码尽可能可维护。熟练的软件开发人员是编写高度可维护代码的人。这意味着代码清晰、易于理解且易于更改，而不会有人在应用程序中引入一些不必要的副作用。
我们可以遵循一个简单的规则来帮助我们创建可维护的代码：童子军规则。
童子军规则的传说说：
让露营地比你发现的更干净。
我没有证据表明这条规则曾经被真正的球探使用过。这更有可能是童子军运动的创始人罗伯特·巴登-鲍威尔（Robert Baden-Powell）去世前留给该运动的信息的变体。在那条信息中，他说，试着让这个世界比你发现的更好一点。
在《Clean Code》一书中，作者 Robert C. Martin（又名 Uncle Bob）改变了这条规则，使其可以应用于代码。他指出，如果我们在维护代码时应用此规则，那么每次维护代码时，我们都应该始终保持代码更干净、更好，以便其质量会随着时间的推移而提高。我们可以重新表述与软件开发相关的童子军规则，这样它就说，总是让你正在编辑的代码比你发现的要好一点。

Always leave the code you're editing a little better than you found it.

· 变化不一定是巨大的。您将不必重写大段代码。如果您将变量名更改为更好地描述其所持有的值的名称，或者将文档添加到之前缺失的代码片段中，则会略微提高代码质量。
注意
在第12章“代码质量”和附录A“如何将伪代码转换为真实代码”中，我们将更深入地了解如何编写高质量的代码，同时保持可维护性。
既然我们已经对如何将软件提供给我们的用户有了一个想法，那么当我们完成了软件的编写和测试之后，我们就应该仔细研究一下实际的开发过程。